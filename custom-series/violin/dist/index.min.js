/*
* Licensed to the Apache Software Foundation (ASF) under one
* or more contributor license agreements.  See the NOTICE file
* distributed with this work for additional information
* regarding copyright ownership.  The ASF licenses this file
* to you under the Apache License, Version 2.0 (the
* "License"); you may not use this file except in compliance
* with the License.  You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing,
* software distributed under the License is distributed on an
* "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
* KIND, either express or implied.  See the License for the
* specific language governing permissions and limitations
* under the License.
*/
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).violinCustomSeriesInstaller=t()}(this,(function(){"use strict";function e(e){return Math.abs(e)<=1?.75*(1-e*e):0}var t=function(t,n){var l={};if(null==t.context.violins){t.context.violins=[],l=t.context.violins;for(var o=t.dataInsideLength,i=0;i<o;++i){var a=n.value(0,i);null==l[a]&&(l[a]={firstDataIndex:i,data:[]}),l[a].data.push(n.value(1,i))}}else l=t.context.violins;var r,u,s,c=t.itemPayload.symbolSize,d=n.value(0),f=n.value(1),p=n.coord([d,f]),v=t.itemPayload.bandWidthScale,h=(n.coord([1,0])[0]-n.coord([0,0])[0])*(null==v?1:v),y=l[d],g=null;if(y&&y.firstDataIndex===t.dataIndex){for(var m=(r=e,u=1,s=y.data,function(e){for(var t=0,n=0;n<s.length;n++)t+=r((e-s[n])/u);return t/(s.length*u)}),x=t.itemPayload.binCount||100,b=[],I=0;I<x;I++)b.push(I*(10/(x-1)));for(var P=b.map((function(e){return[e,m(e)]})),S=[],C=[],D=function(){if(C.length>1){for(var e=C.length-1;e>=0;--e)C.push([2*p[0]-C[e][0],C[e][1]]);var l=t.itemPayload.areaOpacity;S.push({type:"polygon",shape:{points:C.slice()},style:{fill:n.visual("color"),opacity:null==l?.5:l}})}C.length=0},T=0;T<P.length;++T){var j=n.coord([d,P[T][0]]);P[T][1]<.001?D():C.push([j[0]+h/2*P[T][1],j[1]])}D(),g={type:"group",children:S,silent:!0}}var z={type:"circle",shape:{cx:p[0],cy:p[1],r:null==c?5:c},style:{fill:n.visual("color")}};return g?{type:"group",children:[z,g]}:z};return{install:function(e){e.registerCustomSeries("violin",t)}}}));