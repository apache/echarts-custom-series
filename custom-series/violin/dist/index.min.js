/*
* Licensed to the Apache Software Foundation (ASF) under one
* or more contributor license agreements.  See the NOTICE file
* distributed with this work for additional information
* regarding copyright ownership.  The ASF licenses this file
* to you under the Apache License, Version 2.0 (the
* "License"); you may not use this file except in compliance
* with the License.  You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing,
* software distributed under the License is distributed on an
* "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
* KIND, either express or implied.  See the License for the
* specific language governing permissions and limitations
* under the License.
*/
!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(e="undefined"!=typeof globalThis?globalThis:e||self).violinCustomSeriesInstaller=n()}(this,(function(){"use strict";function e(e){return Math.abs(e)<=1?.75*(1-e*e):0}var n=function(n,t){var i={};if(null==n.context.violins){n.context.violins=[],i=n.context.violins;for(var l=n.dataInsideLength,o=0;o<l;++o){var a=t.value(0,o);null==i[a]&&(i[a]={firstDataIndex:o,data:[]}),i[a].data.push(t.value(1,o))}}else i=n.context.violins;var r,s,u,d=n.itemPayload.symbolSize,f=t.value(0),c=t.value(1),v=t.coord([f,c]),p=n.itemPayload.bandWidthScale,h=(t.coord([1,0])[0]-t.coord([0,0])[0])*(null==p?1:p),y=i[f],g=null;if(y&&y.firstDataIndex===n.dataIndex){for(var m=(r=e,s=1,u=y.data,function(e){for(var n=0,t=0;t<u.length;t++)n+=r((e-u[t])/s);return n/(u.length*s)}),x=n.itemPayload.binCount||100,b=[],I=0;I<x;I++)b.push(I*(10/(x-1)));for(var S=b.map((function(e){return[e,m(e)]})),C=[],w=[],P=function(){if(w.length>1){for(var e=w.length-1;e>=0;--e)w.push([2*v[0]-w[e][0],w[e][1]]);var i=n.itemPayload.areaOpacity;C.push({type:"polygon",shape:{points:w.slice()},style:{fill:t.visual("color"),opacity:null==i?.5:i}})}w.length=0},D=0;D<S.length;++D){var T=t.coord([f,S[D][0]]);S[D][1]<.001?P():w.push([T[0]+h/2*S[D][1],T[1]])}P(),g={type:"group",children:C,silent:!0}}var j={type:"circle",shape:{cx:v[0],cy:v[1],r:null==d?5:d},style:{fill:t.visual("color")}};return g?{type:"group",children:[j,g]}:j};return{install:function(e){e.registerCustomSeries("violin",n)}}})),"undefined"!=typeof window&&(window.violinCustomSeriesInstaller=violinCustomSeriesInstaller);